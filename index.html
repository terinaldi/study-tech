<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Study Tech</title>
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#8B0000"/>
  <!-- iOS support -->
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="icon.png">
  <link rel="apple-touch-icon" sizes="512x512" href="icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Study Tech">
  <style>
    :root {
      --primary: #8B0000;
      --accent: #A52A2A;
      --gold: #D4AF37;
      --light-bg: #F8F7F5;
      --card-bg: #FFFFFF;
      --shadow: 0 6px 20px rgba(139, 0, 0, 0.12);
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--light-bg);
      color: #222;
      line-height: 1.65;
      font-size: 17px;
      -webkit-font-smoothing: antialiased;
    }

    header {
      background: linear-gradient(180deg, #C41E3A 0%, var(--primary) 100%);
      color: white;
      text-align: center;
      padding: 2.8rem 1.2rem 2.2rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.18);
      position: relative;
    }

    header::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 12px;
      background: linear-gradient(transparent, var(--light-bg));
    }

    .header-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }

    .logo {
      font-size: 3.6rem;
      line-height: 1;
      filter: drop-shadow(0 3px 6px rgba(0,0,0,0.25));
    }

    h1 {
      margin: 0;
      font-size: 2.65rem;
      font-weight: 700;
      letter-spacing: -0.5px;
    }

    .subtitle {
      color: var(--gold);
      font-size: 1.18rem;
      font-weight: 500;
      letter-spacing: 0.6px;
      margin: 0;
      opacity: 0.95;
    }

    .container {
      max-width: 920px;
      margin: 0 auto;
      padding: 1.2rem 1rem 2rem;
    }

    h2 {
      color: var(--primary);
      font-size: 2.05rem;
      font-weight: 700;
      margin: 2.2rem 0 1rem;
      letter-spacing: -0.4px;
    }

    h3 {
      color: var(--accent);
      font-size: 1.65rem;
      margin: 2rem 0 1rem;
      font-weight: 600;
    }

    /* Sleek iOS-style list buttons */
    .barrier-btn {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      padding: 1.35rem 1.4rem;
      margin: 1rem 0;
      background: white;
      color: #222;
      border: none;
      border-radius: 18px;
      font-size: 1.32rem;
      font-weight: 500;
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: all 0.28s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .barrier-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(139, 0, 0, 0.18);
    }

    .barrier-btn:active {
      transform: scale(0.985);
    }

    .btn-left {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .icon {
      font-size: 2.1rem;
      width: 38px;
      flex-shrink: 0;
    }

    .chevron {
      font-size: 2.4rem;
      color: #CCC;
      font-weight: 300;
      line-height: 1;
    }

    /* Pages */
    .page {
      display: none;
      background: var(--card-bg);
      margin: 1rem 0;
      padding: 2rem 1.6rem 3rem;
      border-radius: 22px;
      box-shadow: var(--shadow);
      min-height: 70vh;
    }

    .page h2 {
      margin-top: 0;
      text-align: center;
    }

    /* Back button - iOS style */
    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: transparent;
      color: var(--primary);
      border: 2px solid var(--primary);
      padding: 0.85rem 1.6rem;
      border-radius: 9999px;
      font-size: 1.22rem;
      font-weight: 600;
      margin-bottom: 1.8rem;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .back-btn:hover {
      background: var(--primary);
      color: white;
    }

    /* Dictionary - modern card */
    #dict-section {
      background: var(--card-bg);
      border-radius: 22px;
      padding: 2rem 1.6rem;
      box-shadow: var(--shadow);
      margin-top: 2rem;
    }

    .input-group {
      position: relative;
      margin: 1.2rem 0;
    }

    #word-input {
      width: 100%;
      padding: 1.25rem 3.8rem 1.25rem 1.4rem;
      font-size: 1.32rem;
      border: 2.5px solid #DDD;
      border-radius: 16px;
      background: white;
      transition: border 0.25s;
    }

    #word-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(139, 0, 0, 0.1);
    }

    .clear-btn {
      position: absolute;
      right: 1.1rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.9rem;
      color: #999;
      cursor: pointer;
      width: 36px;
      height: 36px;
      display: none;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: color 0.2s;
    }

    .clear-btn:hover {
      color: var(--primary);
      background: #f0f0f0;
    }

    #level-select {
      width: 100%;
      padding: 1.1rem 1.2rem;
      font-size: 1.22rem;
      border: 2.5px solid #DDD;
      border-radius: 16px;
      background: white;
      margin-bottom: 1.2rem;
    }

    #search-btn {
      width: 100%;
      background: var(--primary);
      color: white;
      border: none;
      padding: 1.35rem;
      border-radius: 16px;
      font-size: 1.3rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 14px rgba(139, 0, 0, 0.25);
      transition: all 0.25s ease;
    }

    #search-btn:hover {
      background: var(--accent);
      transform: translateY(-2px);
    }

    /* Dictionary result - sleek cards */
    .dict-result {
      margin-top: 2rem;
    }

    .dict-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.2rem;
      flex-wrap: wrap;
      gap: 12px;
    }

    .dict-header h3 {
      margin: 0;
      font-size: 2.1rem;
      color: #111;
    }

    .audio-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.7rem 1.4rem;
      border-radius: 9999px;
      font-size: 1.05rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .meaning-card {
      background: #FAFAFA;
      border-radius: 16px;
      padding: 1.4rem;
      margin-bottom: 1.6rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.06);
    }

    .pos {
      background: var(--primary);
      color: white;
      font-size: 1.05rem;
      padding: 4px 16px;
      border-radius: 9999px;
      display: inline-block;
      margin-bottom: 1rem;
      font-weight: 600;
    }

    .def-item {
      padding: 0.9rem 0;
      border-bottom: 1px solid #EEE;
      font-size: 1.1rem;
    }

    .def-item:last-child {
      border-bottom: none;
    }

    .def-item em {
      color: #555;
      font-style: italic;
    }

    .origin-box {
      background: #FFF9E6;
      border-left: 5px solid var(--gold);
      padding: 1.1rem 1.4rem;
      border-radius: 12px;
      margin: 1.6rem 0;
      font-size: 1.05rem;
    }

    /* Video */
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      margin: 2rem 0;
      border-radius: 18px;
      box-shadow: var(--shadow);
    }

    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    ol, ul {
      padding-left: 1.6rem;
    }

    li {
      margin-bottom: 1rem;
      font-size: 1.12rem;
    }

    strong {
      color: var(--primary);
    }

    /* Footer note */
    .footer-note {
      text-align: center;
      color: #777;
      font-size: 0.95rem;
      margin-top: 3rem;
      padding-top: 1.5rem;
      border-top: 1px solid #EEE;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">üìñ</div>
      <h1>Study Tech</h1>
      <p class="subtitle">L. Ron Hubbard‚Äôs Technology of Study</p>
    </div>
  </header>

  <div class="container">
    <!-- MAIN MENU -->
    <div id="main-content">
      <section>
        <h2>The Study Barriers</h2>
        <p style="margin-bottom: 1.8rem; opacity: 0.85;">Tap a barrier to master the exact handling from L. Ron Hubbard‚Äôs technology.</p>
        
        <button class="barrier-btn" onclick="showPage('intro')">
          <div class="btn-left">
            <span class="icon">üöß</span>
            <span>Intro: The Barriers to Study</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </button>

        <button class="barrier-btn" onclick="showPage('mass')">
          <div class="btn-left">
            <span class="icon">üß±</span>
            <span>1. Absence of Mass</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </button>

        <button class="barrier-btn" onclick="showPage('gradient')">
          <div class="btn-left">
            <span class="icon">üìà</span>
            <span>2. Skipped Gradient</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </button>

        <button class="barrier-btn" onclick="showPage('word')">
          <div class="btn-left">
            <span class="icon">üî†</span>
            <span>3. Misunderstood Word</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </button>
      </section>

      <section>
        <h2>Word Clearing</h2>
        <button class="barrier-btn" onclick="showPage('why-clear')">
          <div class="btn-left">
            <span class="icon">‚ùì</span>
            <span>Why Clear Your Words?</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </button>
        <button class="barrier-btn" onclick="showPage('how-to-clear')">
          <div class="btn-left">
            <span class="icon">üìã</span>
            <span>How to Clear a Word</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </button>
        <button class="barrier-btn" onclick="showPage('help-another')">
          <div class="btn-left">
            <span class="icon">üë•</span>
            <span>How to Help Another Clear Words</span>
          </div>
          <span class="chevron">‚Ä∫</span>
        </button>
      </section>

      <section id="study-tools">
        <h2>Study Tools</h2>
        <div id="dict-section">
          <h3>Instant Dictionary</h3>
          <p style="margin-bottom: 1.4rem; opacity: 0.8;">Clear any word instantly ‚Äî with origin, audio &amp; level-appropriate definitions.</p>
          
          <select id="level-select">
            <option value="beginner">Beginner / Elementary</option>
            <option value="intermediate" selected>Intermediate</option>
            <option value="advanced">Advanced</option>
          </select>

          <div class="input-group">
            <input type="text" id="word-input" placeholder="Type a word‚Ä¶" autocomplete="off"/>
            <button id="clear-btn" class="clear-btn">‚úï</button>
          </div>

          <button id="search-btn">Look Up Word</button>
          <div id="result"></div>
        </div>
      </section>
    </div>

    <!-- PAGES -->
    <div id="intro" class="page">
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
      <h2>THE BARRIERS TO STUDY</h2>
      <p>From the article by <strong>L. Ron Hubbard</strong></p>
      <p>There are three definite barriers that can block a person‚Äôs ability to study and learn. These barriers produce real physical and mental reactions.</p>
      <p>When you know exactly what they are and how to handle them, your study speed and understanding soar.</p>
      <div class="video-container">
        <iframe src="https://www.youtube.com/embed/M-iQD2B7ZjE?start=110" title="Study Technology" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
    </div>

    <div id="mass" class="page">
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
      <h2>1. Absence of Mass</h2>
      <p>The printed page or spoken word is no substitute for the actual object. Without the mass (the real thing or a good mock-up), understanding is impossible.</p>
      <p>You can actually feel ‚Äúsquashed,‚Äù spinny, dead, or bored when mass is missing.</p>
      <p>Knowing this barrier lets you handle it instantly ‚Äî and get real comprehension.</p>
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
    </div>

    <div id="gradient" class="page">
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
      <h2>2. Skipped Gradient</h2>
      <p>A gradient is learning step by step, each step easy enough to do.</p>
      <p>When you skip a step or hit a gradient that‚Äôs too steep, you get confusion or a reeling feeling.</p>
      <p>The remedy is simple: go back to the last point you fully understood and proceed slowly again.</p>
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
    </div>

    <div id="word" class="page">
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
      <h2>3. Misunderstood Word</h2>
      <p>The most important barrier. A word you don‚Äôt fully understand stops all forward progress.</p>
      <p>You go blank, feel ‚Äúnot there,‚Äù or even sleepy. It is the primary source of stupidity and inability.</p>
      <p>Clear every misunderstood word the moment you slow down or feel less bright.</p>
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
    </div>

    <div id="why-clear" class="page">
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
      <h2>Why Clear Your Words?</h2>
      <p>Never leave a word you don‚Äôt fully understand. It is the only thing that can stop your study cold.</p>
      <p>When you feel less bright, slower, or start yawning ‚Äî you passed a misunderstood word earlier.</p>
      <p>Basic Word Clearing finds it fast and restores your enthusiasm and speed.</p>
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
    </div>

    <div id="how-to-clear" class="page">
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
      <h2>How to Clear a Word</h2>
      <ol>
        <li>Notice you are not as bright, interested, or fast as you were a few minutes ago.</li>
        <li>Stop and look earlier in the text for the misunderstood word (it is always there).</li>
        <li>Find it. Look it up in a good dictionary and clear every definition that fits the context.</li>
        <li>Use the word in several sentences until you fully understand it.</li>
        <li>Read the section again. You will feel bright and eager to continue.</li>
      </ol>
      <p><strong>Summary:</strong> Find where you were fine ‚Üí find where you got stuck ‚Üí the misunderstood word is right there at the transition point.</p>
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
    </div>

    <div id="help-another" class="page">
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
      <h2>How to Help Another Clear Words</h2>
      <h3>Simple Reading Aloud Word Clearing</h3>
      <p>Perfect for children, non-native speakers, or anyone who needs extra help.</p>
      <ol>
        <li>Have the student read aloud while you follow along.</li>
        <li>Any hesitation, frown, omission, or change of word = stop immediately.</li>
        <li>Clear the word on the spot using a dictionary.</li>
        <li>Continue reading.</li>
      </ol>
      <p>After a few sessions the person will read fluently and happily.</p>
      <button class="back-btn" onclick="showPage('main')">‚Üê Back to Main</button>
    </div>
  </div>

  <div class="footer-note">
    Built with L. Ron Hubbard‚Äôs Study Technology ‚Ä¢ For students who want to learn fast and understand fully
  </div>

  <script>
    let currentWord = '';

    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(el => el.style.display = 'none');
      document.getElementById('main-content').style.display = 'none';

      if (pageId === 'main') {
        document.getElementById('main-content').style.display = 'block';
      } else {
        document.getElementById(pageId).style.display = 'block';
      }
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Dictionary functions
    async function lookupWord() {
      const word = document.getElementById('word-input').value.trim().toLowerCase();
      if (!word) return;

      currentWord = word;
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '<p style="text-align:center; color:#777; padding:2rem;">Looking up‚Ä¶</p>';

      const level = document.getElementById('level-select').value;

      try {
        const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
        if (!res.ok) throw new Error('Not found');

        const data = await res.json();
        const entry = data[0];

        let html = `<div class="dict-result">`;

        // Header with word + audio
        const phonetic = entry.phonetic ? ` <small style="color:#555;">/${entry.phonetic}/</small>` : '';
        html += `<div class="dict-header"><h3>${entry.word}${phonetic}</h3>`;

        // Pronunciation button
        let audioUrl = null;
        if (entry.phonetics && entry.phonetics.length) {
          const phoneticWithAudio = entry.phonetics.find(p => p.audio);
          if (phoneticWithAudio) {
            audioUrl = phoneticWithAudio.audio;
            html += `<button class="audio-btn" onclick="playPronunciation('${audioUrl}')">üîä Pronounce</button>`;
          }
        }
        html += `</div>`;

        // Origin
        if (entry.origin && entry.origin.trim()) {
          html += `<div class="origin-box"><strong>Origin:</strong> ${entry.origin}</div>`;
        }

        // Meanings
        entry.meanings.forEach(meaning => {
          const pos = meaning.partOfSpeech.charAt(0).toUpperCase() + meaning.partOfSpeech.slice(1);
          html += `<div class="meaning-card">`;
          html += `<span class="pos">${pos}</span>`;

          let defs = meaning.definitions;
          if (level === 'beginner') {
            defs = defs.filter(d => d.definition.length <= 70).slice(0, 2);
          } else if (level === 'intermediate') {
            defs = defs.filter(d => d.definition.length <= 130).slice(0, 4);
          }
          // advanced = all

          defs.forEach((def, i) => {
            html += `<div class="def-item">${i+1}. ${def.definition}`;
            if (def.example) html += ` <em>(e.g. ‚Äú${def.example}‚Äù)</em>`;
            html += `</div>`;
          });

          html += `</div>`;
        });

        html += `</div>`;
        resultDiv.innerHTML = html;

      } catch (err) {
        resultDiv.innerHTML = `<p style="color:#8B0000; text-align:center; padding:2rem; font-size:1.15rem;">Word not found.<br>Try another spelling or a different word.</p>`;
      }
    }

    function playPronunciation(url) {
      const audio = new Audio(url);
      audio.play().catch(() => {
        alert("Pronunciation audio not available for this word.");
      });
    }

    // Clear button
    const wordInput = document.getElementById('word-input');
    const clearBtn = document.getElementById('clear-btn');

    wordInput.addEventListener('input', () => {
      clearBtn.style.display = wordInput.value.trim() ? 'flex' : 'none';
    });

    clearBtn.addEventListener('click', () => {
      wordInput.value = '';
      clearBtn.style.display = 'none';
      document.getElementById('result').innerHTML = '';
      currentWord = '';
      wordInput.focus();
    });

    // Search triggers
    document.getElementById('search-btn').addEventListener('click', lookupWord);

    wordInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') lookupWord();
    });

    document.getElementById('level-select').addEventListener('change', () => {
      if (currentWord) lookupWord();
    });

    // Show main on load
    showPage('main');

    // PWA service worker (unchanged)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').catch(() => {});
      });
    }
  </script>
</body>
</html>
