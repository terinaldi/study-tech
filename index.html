<script>
  function showPage(pageId) {
    document.querySelectorAll('.page').forEach(el => el.style.display = 'none');
    document.getElementById('main-content').style.display = 'none';

    if (pageId === 'main') {
      document.getElementById('main-content').style.display = 'block';
    } else {
      document.getElementById(pageId).style.display = 'block';
    }
  }
  showPage('main');

  // Dictionary lookup - more condensed, grouped POS, origin only if present
  document.getElementById('search-btn').addEventListener('click', async () => {
    const word = document.getElementById('word-input').value.trim().toLowerCase();
    if (!word) {
      alert('Please enter a word!');
      return;
    }
    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = '<p>Loading...</p>';

    try {
      const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
      if (!res.ok) throw new Error('Not found');
      const data = await res.json();
      const entry = data[0];

      let html = `<h3>${entry.word}${entry.phonetic ? ` <small>(${entry.phonetic})</small>` : ''}</h3>`;

      // Origin only if available
      if (entry.origin && entry.origin.trim() !== '') {
        html += `<p><strong>Origin/Derivation:</strong> ${entry.origin}</p>`;
      } // No fallback message to keep minimal; can add if wanted

      // Group by POS, max 2 defs each
      entry.meanings.forEach(meaning => {
        const pos = meaning.partOfSpeech.charAt(0).toUpperCase() + meaning.partOfSpeech.slice(1);
        html += `<p class="pos">${pos}</p>`;

        meaning.definitions.slice(0, 2).forEach((def, index) => {
          html += `<p>${index + 1}. ${def.definition}`;
          if (def.example) html += ` <em>(e.g., ${def.example})</em>`;
          html += `</p>`;
        });
      });

      // Optional fallback link for etymology
      html += `<p><small>For more etymology, check <a href="https://www.etymonline.com/word/${word}" target="_blank" style="color: #8B0000;">etymonline.com</a></small></p>`;

      resultDiv.innerHTML = html;
    } catch (err) {
      resultDiv.innerHTML = '<p style="color: #8B0000;">Word not found or no connection. Try another!</p>';
    }
  });

  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js');
    });
  }
</script>
