<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover"/>
  <title>Study Tech</title>
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#1e40af"/>
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Study Tech">
  <meta name="format-detection" content="telephone=no">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    :root {
      --primary: #1e40af;
      --accent: #3b82f6;
      --text: #111827;
      --text-light: #ffffff;
      --text-secondary: #4b5563;
      --bg: #f9fafb;
      --card: #ffffff;
      --border: #e5e7eb;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
      --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
      --safe-bottom: 48px;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.55;
      font-size: 17px;
      margin: 0;
      padding-top: env(safe-area-inset-top);
      padding-bottom: calc(env(safe-area-inset-bottom) + var(--safe-bottom));
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      -webkit-text-size-adjust: 100%;
      text-rendering: optimizeLegibility;
    }

    header {
      background: var(--primary);
      color: var(--text-light);
      text-align: center;
      padding: calc(1.5rem + env(safe-area-inset-top)) 1.2rem 1.1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.14);
    }

    h1 { margin:0; font-size:2.35rem; font-weight:800; letter-spacing:-0.6px; line-height:1.12; }
    .subtitle { margin:0.45rem 0 0; font-size:1.05rem; font-weight:400; color:#ffffff; opacity:1; letter-spacing:0.2px; }

    .container { max-width:960px; margin:0 auto; padding:1.2rem 1rem calc(5rem + env(safe-area-inset-bottom)); }

    h2 { color:var(--primary); font-size:2.1rem; font-weight:700; margin:2.5rem 0 1.3rem; letter-spacing:-0.3px; }
    h3 { color:var(--accent); font-size:1.7rem; font-weight:650; margin:2.1rem 0 1.1rem; }

    p, li { font-size:1.06rem; margin:1.1rem 0; color:var(--text-secondary); }
    .page p, .page li { font-size:1.09rem; line-height:1.75; }

    .barrier-btn {
      width:100%; padding:1.3rem 1.5rem; margin:1rem 0; background:white; border:none; border-radius:16px;
      font-size:1.32rem; font-weight:600; text-align:left; box-shadow:var(--shadow-sm); cursor:pointer;
      display:flex; justify-content:space-between; align-items:center; transition:all 0.22s ease;
    }

    .barrier-btn:hover { transform:translateY(-1px); box-shadow:var(--shadow-md); }

    .btn-left { display:flex; align-items:center; gap:1.1rem; }
    .btn-icon { font-size:1.75rem; color:var(--primary); width:40px; }
    .chevron { font-size:2.3rem; color:#9ca3af; }

    .page { display:none; background:white; margin:1rem 0; padding:2rem 1.5rem 5rem; border-radius:20px; box-shadow:var(--shadow-md); }

    .mass-image, .skipped-image, .mu-image { width:100%; height:auto; border-radius:14px; margin:2rem 0; display:block; }

    .back-btn {
      background:transparent; color:var(--primary); border:2px solid var(--primary); padding:0.9rem 1.8rem;
      border-radius:999px; font-size:1.2rem; font-weight:600; margin-bottom:1.8rem; cursor:pointer;
      transition:all 0.2s;
    }

    .back-btn:hover { background:var(--primary); color:white; }

    /* How to Clear a Word - Clean Manual Style */
    #how-to-clear ol {
      counter-reset: step;
      padding-left:0;
      list-style:none;
      margin:2rem 0;
    }

    #how-to-clear li {
      counter-increment: step;
      margin:2.5rem 0;
      padding-left:4.5rem;
      position:relative;
      font-size:1.18rem;
      line-height:1.7;
    }

    #how-to-clear li:before {
      content: counter(step);
      position:absolute;
      left:0;
      top:-0.3rem;
      width:3.6rem;
      height:3.6rem;
      background:var(--primary);
      color:white;
      font-weight:800;
      font-size:1.8rem;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 4px 12px rgba(30,64,175,0.3);
    }

    #dict-section {
      background:white;
      border-radius:20px;
      padding:2rem 1.5rem;
      box-shadow:var(--shadow-md);
      margin-top:2.5rem;
    }

    .input-group { position:relative; margin:1.5rem 0; }

    #word-input {
      width:100%;
      padding:1.3rem 4.2rem 1.3rem 1.5rem;
      font-size:1.32rem;
      border:2px solid var(--border);
      border-radius:14px;
    }

    #word-input:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px rgba(59,130,246,0.15); }

    .clear-btn {
      position:absolute;
      right:1.2rem;
      top:50%;
      transform:translateY(-50%);
      background:transparent;
      border:none;
      font-size:2rem;
      color:#9ca3af;
      cursor:pointer;
      width:40px;
      height:40px;
      display:none;
      align-items:center;
      justify-content:center;
    }

    #level-select {
      width:100%;
      padding:1.3rem;
      font-size:1.28rem;
      border:2px solid var(--border);
      border-radius:14px;
      margin-bottom:1.3rem;
    }

    #search-btn {
      width:100%;
      background:var(--primary);
      color:white;
      border:none;
      padding:1.3rem;
      border-radius:14px;
      font-size:1.32rem;
      font-weight:600;
      cursor:pointer;
    }

    #search-btn:hover { background:var(--accent); }

    #result { margin-top:2.2rem; }

    .dict-word { font-size:2.4rem; font-weight:700; margin-bottom:0.4rem; }

    .phonetic-wrapper { display:flex; align-items:center; gap:0.8rem; margin-bottom:1.2rem; }

    .phonetic { color:var(--text-secondary); font-size:1.28rem; font-style:italic; }

    .audio-btn {
      background:transparent;
      border:none;
      color:var(--accent);
      font-size:1.5rem;
      cursor:pointer;
      padding:0.5rem;
      border-radius:50%;
      transition:all 0.2s;
    }

    .audio-btn:hover { background:rgba(59,130,246,0.12); }

    .pos { color:var(--primary); font-weight:700; font-size:1.45rem; margin:1.8rem 0 0.9rem; display:block; }

    .def-item { margin:1.2rem 0; font-size:1.12rem; }

    .example { color:var(--text-secondary); font-style:italic; }

    .origin {
      background:#eff6ff;
      border-left:4px solid var(--primary);
      padding:1.2rem 1.5rem;
      margin:1.8rem 0;
      border-radius:10px;
      font-size:1.06rem;
    }

    .video-container {
      position:relative;
      padding-bottom:56.25%;
      height:0;
      overflow:hidden;
      margin:2.2rem 0;
      border-radius:16px;
      box-shadow:var(--shadow-md);
    }

    .video-container iframe {
      position:absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    }

    .footer-note {
      text-align:center;
      color:#6b7280;
      font-size:0.92rem;
      margin:5rem 0 7rem;
      padding-top:2rem;
      border-top:1px solid var(--border);
    }
  </style>
</head>
<body>
  <header>
    <h1>Study Tech</h1>
    <p class="subtitle">Master Learning with Proven Study Technology</p>
  </header>

  <div class="container">
    <div id="main-content">
      <section>
        <h2>The Study Barriers</h2>
        <p class="section-intro">Tap each barrier to learn more about what can block effective study.</p>

        <button class="barrier-btn" onclick="showPage('intro')">
          <div class="btn-left">
            <i class="fa-solid fa-book-open btn-icon"></i>
            <span>Intro: The Barriers to Study</span>
          </div>
          <span class="chevron">›</span>
        </button>

        <button class="barrier-btn" onclick="showPage('mass')">
          <div class="btn-left">
            <i class="fa-solid fa-cube btn-icon"></i>
            <span>1. Absence of Mass</span>
          </div>
          <span class="chevron">›</span>
        </button>

        <button class="barrier-btn" onclick="showPage('gradient')">
          <div class="btn-left">
            <i class="fa-solid fa-chart-line btn-icon"></i>
            <span>2. Skipped Gradient</span>
          </div>
          <span class="chevron">›</span>
        </button>

        <button class="barrier-btn" onclick="showPage('word')">
          <div class="btn-left">
            <i class="fa-solid fa-question-circle btn-icon"></i>
            <span>3. Misunderstood Word</span>
          </div>
          <span class="chevron">›</span>
        </button>
      </section>

      <section>
        <h2>Word Clearing</h2>
        <button class="barrier-btn" onclick="showPage('why-clear')">
          <div class="btn-left">
            <i class="fa-solid fa-lightbulb btn-icon"></i>
            <span>Why Clear Your Words?</span>
          </div>
          <span class="chevron">›</span>
        </button>

        <button class="barrier-btn" onclick="showPage('how-to-clear')">
          <div class="btn-left">
            <i class="fa-solid fa-magnifying-glass btn-icon"></i>
            <span>How to Clear a Word</span>
          </div>
          <span class="chevron">›</span>
        </button>

        <button class="barrier-btn" onclick="showPage('help-another')">
          <div class="btn-left">
            <i class="fa-solid fa-users btn-icon"></i>
            <span>How to Help Another Clear Words</span>
          </div>
          <span class="chevron">›</span>
        </button>
      </section>

      <section id="study-tools">
        <h2>Study Tools</h2>
        <div id="dict-section">
          <h3>Built-in Dictionary</h3>
          <p>Simple lookup: definitions + origin/derivation + audio pronunciation when available.</p>

          <select id="level-select">
            <option value="beginner">Beginner / Elementary Level</option>
            <option value="intermediate" selected>Intermediate</option>
            <option value="advanced">Advanced</option>
          </select>

          <div class="input-group">
            <input type="text" id="word-input" placeholder="Enter a word (e.g., epistemology)" />
            <button id="clear-btn" class="clear-btn">×</button>
          </div>

          <button id="search-btn">Look Up</button>
          <div id="result"></div>
        </div>
      </section>
    </div>

    <!-- All other pages unchanged – only updating how-to-clear -->

    <div id="how-to-clear" class="page">
      <button class="back-btn" onclick="showPage('main')">← Back to Main</button>
      <h2>How to Clear a Word</h2>

      <h3>When to clear your word:</h3>
      <ol>
        <li>You realize that you are not moving along on your studies as fast as you were or that you are not as bright as you were earlier. It might also be one of the following: You are just not as interested in what you are studying. You are taking too long to get through something. You might be yawning. You might be doodling (scribbling or making patterns or designs with a pen or pencil). You might be daydreaming, etc.</li>

        <li>As soon as this happens, you must stop and look earlier in what you were studying and find the misunderstood word. There will always be one there and you must find it. There are no exceptions. It may be that the misunderstood word is two pages or more before the place where you stopped studying. But it is always earlier in the text than where you are now.</li>

        <li>You find the word. You may recognize it while looking back for it, but if you can’t find it, you or the person helping you with your study can pick out words from what you were reading that could be the misunderstood word. Someone helping you can ask, “What does ______ mean?” to see if you give the correct definition.</li>
      </ol>

      <h3>How to Clear your word:</h3>
      <ol>
        <li>When you have found the misunderstood word, you look it up in a dictionary and clear it per the Steps to Clear a Word section of this course.</li>

        <li>You look up and clear the definition that fits the context.</li>

        <li>You use it in sentences that you make up, until you fully understand it.</li>

        <li>Then you clear each of the listed definitions and use each of them several times in sentences until you fully understand the word.</li>

        <li>You then clear the derivation and any idioms or synonyms, etc.</li>
      </ol>

      <h3>Completion:</h3>
      <ol>
        <li>Now that you have a full understanding of the word, you go back to what you were reading and once again read the part that contained the misunderstood word. If you are still not “bright,” wanting to get on with it and feeling happier about it, then there is another misunderstood word earlier in the text. You must find it and clear it by repeating steps 2 to 5 above.</li>

        <li>When you feel bright and enthusiastic again, that is the end result of Basic Word Clearing. (The result won’t be achieved if a word you did not understand was missed or if there is an earlier misunderstood word in the text. If this happens, repeat steps 2 to 5.) If you are now enthusiastic, continue studying the text from where the misunderstood was found and cleared.</li>
      </ol>

      <button class="back-btn" onclick="showPage('main')">← Back to Main</button>
    </div>

    <!-- All other pages (intro, mass, gradient, word, why-clear, help-another) remain unchanged from previous version -->

  </div>

  <div class="footer-note">
    Powered by L. Ron Hubbard’s Study Technology • Designed for focused, high-performance learning
  </div>

  <script>
    let currentWord = '';

    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(el => el.style.display = 'none');
      document.getElementById('main-content').style.display = 'none';
      if (pageId === 'main') {
        document.getElementById('main-content').style.display = 'block';
      } else {
        document.getElementById(pageId).style.display = 'block';
      }
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    showPage('main');

    async function lookupWord() {
      const word = document.getElementById('word-input').value.trim().toLowerCase();
      if (!word) return;
      currentWord = word;
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '<p style="text-align:center; color:#777; padding:2.5rem 0;">Loading...</p>';
      const level = document.getElementById('level-select').value;
      try {
        const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
        if (!res.ok) throw new Error('Not found');
        const data = await res.json();
        const entry = data[0];

        let html = `<h3 class="dict-word">${entry.word}</h3>`;

        if (entry.phonetics && entry.phonetics.length > 0) {
          const phoneticWithAudio = entry.phonetics.find(p => p.audio && p.audio.trim() !== '');
          if (phoneticWithAudio) {
            const audioId = `audio-${word.replace(/\W/g, '')}`;
            html += `
              <div class="phonetic-wrapper">
                <span class="phonetic">${entry.phonetic || phoneticWithAudio.text || ''}</span>
                <button class="audio-btn" onclick="document.getElementById('${audioId}').play()">
                  <i class="fa-solid fa-volume-high"></i>
                </button>
                <audio id="${audioId}" src="${phoneticWithAudio.audio}"></audio>
              </div>`;
          } else {
            html += `<div class="phonetic">${entry.phonetic || ''}</div>`;
          }
        }

        if (entry.origin && entry.origin.trim()) {
          html += `<div class="origin"><strong>Origin / Derivation:</strong><br>${entry.origin}</div>`;
        }

        entry.meanings.forEach(meaning => {
          const pos = meaning.partOfSpeech.charAt(0).toUpperCase() + meaning.partOfSpeech.slice(1);
          html += `<div class="pos">${pos}</div>`;
          let defs = meaning.definitions;
          if (level === 'beginner') {
            defs = defs.filter(def => def.definition.length <= 60);
            if (defs.length > 1) defs = defs.slice(0, 1);
          } else if (level === 'intermediate') {
            defs = defs.filter(def => def.definition.length <= 120);
            if (defs.length > 3) defs = defs.slice(0, 3);
          }
          defs.forEach((def, index) => {
            html += `<p class="def-item">${index + 1}. ${def.definition}`;
            if (def.example) html += ` <span class="example">Example: ${def.example}</span>`;
            html += `</p>`;
          });
        });

        resultDiv.innerHTML = html;
      } catch (err) {
        resultDiv.innerHTML = '<p style="color:var(--primary); text-align:center; padding:2.5rem 0; font-size:1.15rem;">Word not found or offline.<br>Please check spelling and try again.</p>';
      }
    }

    document.getElementById('search-btn').addEventListener('click', lookupWord);
    document.getElementById('word-input').addEventListener('keypress', e => {
      if (e.key === 'Enter') lookupWord();
    });
    document.getElementById('level-select').addEventListener('change', () => {
      if (currentWord) lookupWord();
    });

    const wordInput = document.getElementById('word-input');
    const clearBtn = document.getElementById('clear-btn');
    wordInput.addEventListener('input', () => {
      clearBtn.style.display = wordInput.value.trim() ? 'flex' : 'none';
    });
    clearBtn.addEventListener('click', () => {
      wordInput.value = '';
      clearBtn.style.display = 'none';
      document.getElementById('result').innerHTML = '';
      currentWord = '';
      wordInput.focus();
    });

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').catch(() => {});
      });
    }
  </script>
</body>
</html>
